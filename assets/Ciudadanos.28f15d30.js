import{g as P,v as B,s as k,C as p}from"./ui.popup.b86fecb0.js";import{D as y,a as S,_ as T,g as G,n as x}from"./notify.a8f63518.js";import{D as N,b as E,c as A,d as F,e as I,f as z,g as U,h as H,i as R,j,k as q,x as M,l as W}from"./data-grid.0d66678a.js";import{D as $,_ as O,a as J}from"./scroll-view.718b5d47.js";import{_ as K}from"./check-box.cb9475e9.js";import{e as L,a as Q,s as X}from"./FileSaver.min.6c75b891.js";import{_ as Y,r as s,o as Z,c as ee,a as o,w as u,b as l,aC as oe}from"./index.b67f4c45.js";const te=async e=>{let t=await P(p,e);return t.sort((a,d)=>a.name>d.name?1:a.name===d.name?0:-1),t.forEach(a=>{a.enabled=a.enabled==null?!0:a.enabled}),t},le=async e=>{e.id||(e.active=!0),B(e,[{name:"name",descripcion:"Nombre",required:!0},{name:"dni",descripcion:"DNI",required:!0}]),await k(p,e)},ae={components:{DxDataGrid:N,DxColumn:E,DxFilterRow:A,DxGrouping:F,DxGroupPanel:I,DxSearchPanel:z,DxHeaderFilter:U,DxScrolling:H,DxGridToolbar:R,DxItem:j,DxSelectBox:$,DxGridButton:q,DxPopup:y,DxToolbarItem:S,DxTextBox:T,DxButton:O,DxScrollView:J,DxCheckBox:K,DxExport:M},data:()=>({showPopup:!1,crudTitle:"Detalle de Ciudadano",items:[],model:{type:{}},newPassword:null}),mounted(){this.listAll()},methods:{create(){G(),this.model={active:!0},this.showPopup=!0},onClosePopup(){this.showPopup=!1},async disable(){W("Seguro deseas cambiar el estado","Confirmar").then(async t=>{try{if(t){let a=Object.assign({},this.model);a.enabled=!1,await le(a),a.id&&(x("Desabilitado con \xE9xito","success",3e3),this.listAll(),this.showPopup=!1)}}catch(a){console.log(a.message),x(a,"error",4e3)}})},showDetail(e){this.model=e,this.newPassword=null,this.showPopup=!0},async listAll(e){this.items=await te(e)},onExporting(e){const t=new L.exports.Workbook,a=t.addWorksheet("Main sheet");Q({component:e.component,worksheet:a,customizeCell:function(d){const m=d;m.font={name:"Arial",size:12},m.alignment={horizontal:"left"}}}).then(function(){t.xlsx.writeBuffer().then(function(d){X(new Blob([d],{type:"application/octet-stream"}),"Ciudadanos.xlsx")})}),e.cancel=!0}}},se={style:{padding:"10px",width:"100vw","box-sizing":"border-box"}},ie=l("label",{style:{"font-size":"1.2em","margin-bottom":"5px"}},"Ciudadanos registrados",-1),de=["onClick"],ne=l("i",{class:"dx-icon-doc"},null,-1),re={class:"dx-field"},ce=l("div",{class:"dx-field-label"},"DNI",-1),ue={class:"dx-field-value"},me={class:"dx-field"},xe=l("div",{class:"dx-field-label"},"Nombre",-1),pe={class:"dx-field-value"},De={class:"dx-field"},he=l("div",{class:"dx-field-label"},"Apellidos",-1),_e={class:"dx-field-value"},fe={class:"dx-field"},be=l("div",{class:"dx-field-label"},"Celular",-1),we={class:"dx-field-value"},ve={class:"dx-field"},ge=l("div",{class:"dx-field-label"},"Direcci\xF3n",-1),Ce={class:"dx-field-value"};function Ve(e,t,a,d,m,r){const D=s("DxFilterRow"),h=s("DxHeaderFilter"),_=s("DxSearchPanel"),f=s("DxScrolling"),b=s("DxExport"),n=s("DxColumn"),w=s("DxButton"),v=s("DxDataGrid"),c=s("DxTextBox"),g=s("DxScrollView"),C=s("DxToolbarItem"),V=s("DxPopup");return Z(),ee("div",se,[ie,o(v,{id:"dataGrid",ref:"dataGridRef","data-source":e.items,"key-expr":"id","show-borders":!0,height:"calc(100vh - 72px)",width:"100%","allow-column-resizing":!0,"column-resizing-mode":"widget",onExporting:r.onExporting},{buttonsTemplate:u(({data:i})=>[l("a",{onClick:Pe=>r.showDetail(i.data),style:{cursor:"pointer",color:"blue"}},[ne,oe("\xA0Ver")],8,de)]),refreshButton:u(()=>[o(w,{icon:"refresh",onClick:r.listAll},null,8,["onClick"])]),default:u(()=>[o(D,{visible:!0}),o(h,{visible:!0}),o(_,{visible:!0,width:240,placeholder:"Buscar..."}),o(f,{mode:"virtual"}),o(b,{enabled:!0,"allow-export-selected-data":!0}),o(n,{width:"120","data-field":"dni",caption:"DNI"}),o(n,{width:"200","data-field":"lastName",caption:"Apellidos","sort-order":"asc"}),o(n,{width:"200","data-field":"name",caption:"Nombre","sort-order":"asc"}),o(n,{width:"120","data-field":"phone",caption:"Celular","sort-order":"asc"}),o(n,{"data-field":"address",caption:"Direcci\xF3n","sort-order":"asc"}),o(n,{width:"120","data-field":"enabled",caption:"Habilitado","data-type":"boolean"}),o(n,{type:"buttons",width:110,"cell-template":"buttonsTemplate"})]),_:1},8,["data-source","onExporting"]),o(V,{visible:e.showPopup,"drag-enabled":!0,"hide-on-outside-click":!1,"show-close-button":!0,"show-title":!0,width:400,height:360,title:e.crudTitle,"on-hidden":r.onClosePopup},{default:u(()=>[o(g,{height:"calc(400px - 135px)"},{default:u(()=>[l("div",re,[ce,l("div",ue,[o(c,{modelValue:e.model.dni,"onUpdate:modelValue":t[0]||(t[0]=i=>e.model.dni=i)},null,8,["modelValue"])])]),l("div",me,[xe,l("div",pe,[o(c,{modelValue:e.model.name,"onUpdate:modelValue":t[1]||(t[1]=i=>e.model.name=i)},null,8,["modelValue"])])]),l("div",De,[he,l("div",_e,[o(c,{modelValue:e.model.lastName,"onUpdate:modelValue":t[2]||(t[2]=i=>e.model.lastName=i)},null,8,["modelValue"])])]),l("div",fe,[be,l("div",we,[o(c,{modelValue:e.model.phone,"onUpdate:modelValue":t[3]||(t[3]=i=>e.model.phone=i)},null,8,["modelValue"])])]),l("div",ve,[ge,l("div",Ce,[o(c,{modelValue:e.model.address,"onUpdate:modelValue":t[4]||(t[4]=i=>e.model.address=i)},null,8,["modelValue"])])])]),_:1}),o(C,{widget:"dxButton",toolbar:"bottom",location:"after",options:{text:"Deshabilitar",type:"danger",onClick:r.disable}},null,8,["options"])]),_:1},8,["visible","title","on-hidden"])])}const Ee=Y(ae,[["render",Ve]]);export{Ee as default};
