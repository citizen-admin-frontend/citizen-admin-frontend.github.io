import{_ as E,a as R,s as T,l as U,y as C,R as O,D as q}from"./plugin-vue_export-helper.c8c60fc3.js";import{s as B,a as A,b as M,c as P,d as F,e as z,f as j,g as G,h as L,i as H,j as K}from"./radiobutton.esm.027fb967.js";import{s as W,g as J,h as d,o as m,c as u,a as s,j as n,d as l,t as g,l as k,n as p,W as x,i as h}from"./index.dd426db0.js";import{s as Q}from"./password.esm.54f04b23.js";import{s as X}from"./checkbox.esm.d9a449c1.js";const Y={components:{Button:W,Dialog:B,FileUpload:A,InputText:R,Toolbar:M,DataTable:P,Column:F,Toast:T,Rating:z,Textarea:j,Dropdown:G,RadioButton:L,InputNumber:H,ScrollPanel:K,Password:Q,Checkbox:X},data(){return{title:"Incidencias Registradas",items:null,showDialog:!1,deleteDialog:!1,model:{},selectedItems:null,filters:{},submitted:!1,fireStore:null,filter:{selectedIncidentStatus:{name:"Abierta",code:"OPEN",backgroundColor:"red"},incidentStatus:[{name:"Abierta",code:"OPEN",backgroundColor:"red"},{name:"En proceso",code:"IN PROGRESS",backgroundColor:"orange"},{name:"Cerrada",code:"CLOSED",backgroundColor:"black"}]}}},mounted(){let i=this;this.getFromFirestore(i)},methods:{getFromFirestore:async i=>{let y=J().appContext.config.globalProperties.$firebaseApp,b=U(y);i.fireStore=b;let e=C(b,"Incidents"),r=await O(e);i.items=r.docs.map(f=>{let a=f.data();return a.id=f.id,a})},openNew(){this.model={},this.submitted=!1,this.showDialog=!0},hideDialog(){this.showDialog=!1,this.submitted=!1},async save(){if(this.submitted=!0,!this.model.username.trim()||!this.model.password.trim()||!this.model.fullName.trim())this.$toast.add({severity:"warn",summary:"Incompleto",detail:"Datos incompletos",life:3e3});else{if(this.model.id)this.$toast.add({severity:"success",summary:"Ok",detail:"Actualizado correctamente",life:3e3});else{this.model.active=!0,this.model.password=btoa(this.model.password);let i=await q(C(this.fireStore,"Incidents"),this.model);this.model.id=i.id,this.items.push(this.model),this.$toast.add({severity:"success",summary:"Ok",detail:"Registro creado",life:3e3})}this.showDialog=!1,this.model={}}},openEdit(i){this.model={...i},this.showDialog=!0},confirmDeleteSelected(){let i=this.selectedItems;console.log(i),i.id==="admin"?this.$toast.add({severity:"warn",summary:"Ok",detail:"No puedes eliminar el administador",life:3e3}):(this.model=i,this.deleteDialog=!0)},deleteSelectedItems(){this.items=this.items.filter(i=>i.id!==this.model.id),this.deleteDialog=!1,this.model={},this.$toast.add({severity:"success",summary:"Ok",detail:"Item eliminado",life:3e3})}}},Z={class:"muniform"},$={class:"container"},ee={class:"container"},te=l("span",null,"Estado:",-1),se={class:"container"},oe={class:"field"},le=l("label",{for:"username"},"Usuario",-1),ie={key:0,class:"p-error"},ae={class:"field"},de=l("label",{for:"password"},"Contrase\xF1a",-1),re={key:0,class:"p-error"},ne={class:"field"},ce=l("label",{for:"fullName"},"Nombres",-1),me={key:0,class:"p-error"},ue={class:"field"},pe=l("label",{for:"active"},"Activo",-1),fe=x(' Checkbox inputId="binary" v-model="checked" :binary="true" /> '),he={class:"confirmation-content"},be=l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),_e={key:0};function ge(i,o,y,b,e,r){const f=d("Toast"),a=d("Button"),D=d("Dropdown"),c=d("Column"),S=d("DataTable"),I=d("ScrollPanel"),v=d("InputText"),N=d("Password"),V=d("Checkbox"),w=d("Dialog");return m(),u("main",Z,[s(f),s(I,{style:{width:"100%",height:"100%"}},{default:n(()=>[l("div",$,[l("h2",null,g(e.title),1)]),l("div",ee,[s(a,{label:"Nuevo",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:r.openNew},null,8,["onClick"]),s(a,{label:"Editar",icon:"pi pi-user-edit",class:"p-button-secondary mr-2",onClick:o[0]||(o[0]=t=>r.openEdit(e.selectedItems)),disabled:!e.selectedItems},null,8,["disabled"]),s(a,{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:r.confirmDeleteSelected,disabled:!e.selectedItems},null,8,["onClick","disabled"]),te,s(D,{modelValue:e.filter.selectedIncidentStatus,"onUpdate:modelValue":o[1]||(o[1]=t=>e.filter.selectedIncidentStatus=t),options:e.filter.incidentStatus,optionLabel:"name"},null,8,["modelValue","options"])]),l("div",se,[s(S,{value:e.items,style:{width:"100%"},selection:e.selectedItems,"onUpdate:selection":o[2]||(o[2]=t=>e.selectedItems=t),dataKey:"id",scrollable:!0,scrollHeight:"calc(100vh - 223px)"},{default:n(()=>[s(c,{selectionMode:"single",headerStyle:"width: 1em; max-width:50px",style:{"max-width":"50px"}}),s(c,{field:"type",header:"Tipo",style:{"max-width":"130px"}},{body:n(t=>[l("span",{style:k({backgroundColor:t.data.type.backgroundColor,color:t.data.type.foregroundColor,padding:"5px",borderRadius:"15px"})},[l("i",{class:p(t.data.type.icon)},null,2),x(" "+g(t.data.type.name),1)],4)]),_:1}),s(c,{field:"description",header:"Descripcion",style:{width:"auto"}}),s(c,{field:"sector",header:"Sector",style:{width:"auto"}}),s(c,{field:"status",header:"Estado",style:{width:"auto","max-width":"100px"}},{body:n(t=>[l("span",{style:k({backgroundColor:e.filter.incidentStatus.filter(_=>_.code==t.data.status)[0].backgroundColor,color:"white",padding:"5px",borderRadius:"15px"})},g(e.filter.incidentStatus.filter(_=>_.code==t.data.status)[0].name),5)]),_:1})]),_:1},8,["value","selection"])])]),_:1}),s(w,{visible:e.showDialog,"onUpdate:visible":o[7]||(o[7]=t=>e.showDialog=t),style:{width:"450px"},header:"Sector",modal:!0,class:"p-fluid"},{footer:n(()=>[s(a,{label:"Cancelar",icon:"pi pi-times",class:"p-button-text",onClick:r.hideDialog},null,8,["onClick"]),s(a,{label:"Guardar",icon:"pi pi-check",class:"p-button-text",onClick:r.save},null,8,["onClick"])]),default:n(()=>[l("div",oe,[le,s(v,{id:"username",modelValue:e.model.username,"onUpdate:modelValue":o[3]||(o[3]=t=>e.model.username=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:p({"p-invalid":e.submitted&&!e.model.username})},null,8,["modelValue","class"]),e.submitted&&!e.model.username?(m(),u("small",ie,"Nombre de usuario es requerido.")):h("",!0)]),l("div",ae,[de,s(N,{id:"password",toggleMask:"",modelValue:e.model.password,"onUpdate:modelValue":o[4]||(o[4]=t=>e.model.password=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:p({"p-invalid":e.submitted&&!e.model.password})},null,8,["modelValue","class"]),e.submitted&&!e.model.password?(m(),u("small",re,"Contrase\xF1a es requerido.")):h("",!0)]),l("div",ne,[ce,s(v,{id:"fullName",modelValue:e.model.fullName,"onUpdate:modelValue":o[5]||(o[5]=t=>e.model.fullName=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:p({"p-invalid":e.submitted&&!e.model.fullName})},null,8,["modelValue","class"]),e.submitted&&!e.model.fullName?(m(),u("small",me,"Nombres es requerido.")):h("",!0)]),l("div",ue,[pe,s(V,{id:"active",modelValue:e.model.active,"onUpdate:modelValue":o[6]||(o[6]=t=>e.model.active=t),modelModifiers:{trim:!0},binary:!0,class:p({"p-invalid":e.submitted})},null,8,["modelValue","class"])]),fe]),_:1},8,["visible"]),s(w,{visible:e.deleteDialog,"onUpdate:visible":o[9]||(o[9]=t=>e.deleteDialog=t),style:{width:"450px"},header:"Confirmar",modal:!0},{footer:n(()=>[s(a,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:o[8]||(o[8]=t=>e.deleteDialog=!1)}),s(a,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:r.deleteSelectedItems},null,8,["onClick"])]),default:n(()=>[l("div",he,[be,e.model?(m(),u("span",_e,"\xBFEst\xE1s seguro que deseas eliminar el registro seleccionado?")):h("",!0)])]),_:1},8,["visible"])])}var xe=E(Y,[["render",ge]]);export{xe as default};
