import{_ as x,a as N,s as I,l as S,y,R as V,D as U}from"./plugin-vue_export-helper.5a311d7c.js";import{s as T,a as q,b as B,c as P,d as E,e as M,f as R,g as F,h as A,i as O,j as z}from"./radiobutton.esm.1f7f892c.js";import{s as j,g as G,h as r,o as m,c,a as t,j as n,d as i,t as H,n as p,i as h,W as K}from"./index.841e0e4e.js";import{s as W}from"./password.esm.707efee9.js";import{s as J}from"./checkbox.esm.22e5aec5.js";const L={components:{Button:j,Dialog:T,FileUpload:q,InputText:N,Toolbar:B,DataTable:P,Column:E,Toast:I,Rating:M,Textarea:R,Dropdown:F,RadioButton:A,InputNumber:O,ScrollPanel:z,Password:W,Checkbox:J},data(){return{title:"Usuarios",items:null,showDialog:!1,deleteDialog:!1,model:{},selectedItems:null,filters:{},submitted:!1,fireStore:null}},mounted(){let l=this;this.getFromFirestore(l)},methods:{getFromFirestore:async l=>{let _=G().appContext.config.globalProperties.$firebaseApp,f=S(_);l.fireStore=f;let e=y(f,"SystemUsers"),d=await V(e);l.items=d.docs.map(u=>{let a=u.data();return a.id=u.id,a})},openNew(){this.model={},this.submitted=!1,this.showDialog=!0},hideDialog(){this.showDialog=!1,this.submitted=!1},async save(){if(this.submitted=!0,!this.model.username.trim()||!this.model.password.trim()||!this.model.fullName.trim())this.$toast.add({severity:"warn",summary:"Incompleto",detail:"Datos incompletos",life:3e3});else{if(this.model.id)this.$toast.add({severity:"success",summary:"Ok",detail:"Actualizado correctamente",life:3e3});else{this.model.active=!0,this.model.password=btoa(this.model.password);let l=await U(y(this.fireStore,"SystemUsers"),this.model);this.model.id=l.id,this.items.push(this.model),this.$toast.add({severity:"success",summary:"Ok",detail:"Registro creado",life:3e3})}this.showDialog=!1,this.model={}}},openEdit(l){this.model={...l},this.showDialog=!0},confirmDeleteSelected(){let l=this.selectedItems;console.log(l),l.id==="admin"?this.$toast.add({severity:"warn",summary:"Ok",detail:"No puedes eliminar el administador",life:3e3}):(this.model=l,this.deleteDialog=!0)},deleteSelectedItems(){this.items=this.items.filter(l=>l.id!==this.model.id),this.deleteDialog=!1,this.model={},this.$toast.add({severity:"success",summary:"Ok",detail:"Item eliminado",life:3e3})}}},Q={class:"muniform"},X={class:"container"},Y={class:"container"},Z={class:"container"},$={class:"field"},ee=i("label",{for:"username"},"Usuario",-1),se={key:0,class:"p-error"},te={class:"field"},le=i("label",{for:"password"},"Contrase\xF1a",-1),oe={key:0,class:"p-error"},ie={class:"field"},ae=i("label",{for:"fullName"},"Nombres",-1),re={key:0,class:"p-error"},de={class:"field"},ne=i("label",{for:"active"},"Activo",-1),me=K(' Checkbox inputId="binary" v-model="checked" :binary="true" /> '),ce={class:"confirmation-content"},ue=i("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),pe={key:0};function he(l,s,_,f,e,d){const u=r("Toast"),a=r("Button"),b=r("Column"),w=r("DataTable"),k=r("ScrollPanel"),v=r("InputText"),C=r("Password"),D=r("Checkbox"),g=r("Dialog");return m(),c("main",Q,[t(u),t(k,{style:{width:"100%",height:"100%"}},{default:n(()=>[i("div",X,[i("h2",null,H(e.title),1)]),i("div",Y,[t(a,{label:"Nuevo",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:d.openNew},null,8,["onClick"]),t(a,{label:"Editar",icon:"pi pi-user-edit",class:"p-button-secondary mr-2",onClick:s[0]||(s[0]=o=>d.openEdit(e.selectedItems)),disabled:!e.selectedItems},null,8,["disabled"]),t(a,{label:"Eliminar",icon:"pi pi-trash",class:"p-button-danger",onClick:d.confirmDeleteSelected,disabled:!e.selectedItems},null,8,["onClick","disabled"])]),i("div",Z,[t(w,{value:e.items,style:{width:"500px"},selection:e.selectedItems,"onUpdate:selection":s[1]||(s[1]=o=>e.selectedItems=o),dataKey:"id",scrollable:!0,scrollHeight:"calc(100vh - 223px)"},{default:n(()=>[t(b,{selectionMode:"single",headerStyle:"width: 1em; max-width:50px",style:{"max-width":"50px"}}),t(b,{field:"username",header:"Usuario"}),t(b,{field:"fullName",header:"Nombres Completos",style:{width:"auto"}})]),_:1},8,["value","selection"])])]),_:1}),t(g,{visible:e.showDialog,"onUpdate:visible":s[6]||(s[6]=o=>e.showDialog=o),style:{width:"450px"},header:"Sector",modal:!0,class:"p-fluid"},{footer:n(()=>[t(a,{label:"Cancelar",icon:"pi pi-times",class:"p-button-text",onClick:d.hideDialog},null,8,["onClick"]),t(a,{label:"Guardar",icon:"pi pi-check",class:"p-button-text",onClick:d.save},null,8,["onClick"])]),default:n(()=>[i("div",$,[ee,t(v,{id:"username",modelValue:e.model.username,"onUpdate:modelValue":s[2]||(s[2]=o=>e.model.username=o),modelModifiers:{trim:!0},required:"true",autofocus:"",class:p({"p-invalid":e.submitted&&!e.model.username})},null,8,["modelValue","class"]),e.submitted&&!e.model.username?(m(),c("small",se,"Nombre de usuario es requerido.")):h("",!0)]),i("div",te,[le,t(C,{id:"password",toggleMask:"",modelValue:e.model.password,"onUpdate:modelValue":s[3]||(s[3]=o=>e.model.password=o),modelModifiers:{trim:!0},required:"true",autofocus:"",class:p({"p-invalid":e.submitted&&!e.model.password})},null,8,["modelValue","class"]),e.submitted&&!e.model.password?(m(),c("small",oe,"Contrase\xF1a es requerido.")):h("",!0)]),i("div",ie,[ae,t(v,{id:"fullName",modelValue:e.model.fullName,"onUpdate:modelValue":s[4]||(s[4]=o=>e.model.fullName=o),modelModifiers:{trim:!0},required:"true",autofocus:"",class:p({"p-invalid":e.submitted&&!e.model.fullName})},null,8,["modelValue","class"]),e.submitted&&!e.model.fullName?(m(),c("small",re,"Nombres es requerido.")):h("",!0)]),i("div",de,[ne,t(D,{id:"active",modelValue:e.model.active,"onUpdate:modelValue":s[5]||(s[5]=o=>e.model.active=o),modelModifiers:{trim:!0},binary:!0,class:p({"p-invalid":e.submitted})},null,8,["modelValue","class"])]),me]),_:1},8,["visible"]),t(g,{visible:e.deleteDialog,"onUpdate:visible":s[8]||(s[8]=o=>e.deleteDialog=o),style:{width:"450px"},header:"Confirmar",modal:!0},{footer:n(()=>[t(a,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:s[7]||(s[7]=o=>e.deleteDialog=!1)}),t(a,{label:"Si",icon:"pi pi-check",class:"p-button-text",onClick:d.deleteSelectedItems},null,8,["onClick"])]),default:n(()=>[i("div",ce,[ue,e.model?(m(),c("span",pe,"\xBFEst\xE1s seguro que deseas eliminar el registro seleccionado?")):h("",!0)])]),_:1},8,["visible"])])}var ye=x(L,[["render",he]]);export{ye as default};
