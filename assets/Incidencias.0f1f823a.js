import{s as $,l as oe}from"./IncidentService.9b821cc6.js";import{D as ie,a as ue,_ as de,g as re,n as z}from"./notify.849dcf7b.js";import{l as se}from"./Sectors.5160b736.js";import{l as pe}from"./IncidentTypeService.a4041ebb.js";import{M as ce}from"./Validator.e0ff0691.js";import{$ as I,ai as he,T as me,s as ge,e as f,d as x,aj as ve,a3 as L,ae as j,ak as G,a8 as N,al as be,K as fe,F as xe,i as Se,a9 as _e,am as De,an as Ce,G as Ee,aa as U,ab as F,ac as M,_ as ye,ao as Ie,r,o as S,c as Fe,a as l,w as p,b as n,ap as Be,aq as K,ar as _,as as C,at as E,au as y}from"./index.35390bee.js";import{L as Oe,D as we,a as Ae,b as Te,c as Ne,d as Me,e as Re,f as He,g as ke,h as Pe,i as Ve,j as $e,k as ze,_ as Le,l as je}from"./scroll-view.0ca84e0b.js";import{c as Ge}from"./dialog.231978d0.js";import"./format_helper.43b668f3.js";var B={},W=function(e,t,o){var i=I(e),s=o?i.scrollLeft():i.scrollTop(),a=o?"Width":"Height",v=i.prop("scroll".concat(a)),c=i.prop("client".concat(a)),h=v-c-s|0;if(s===0&&h===0)return!1;var b=s===0&&t>=0,w=h===0&&t<=0,m=s>0&&h>0;if(b||w||m)return!0},Ke=function(e,t){var o=I(e);return{validate:function(i){if(he(i)&&(s=i.target,t?I(s).is(e):!0))return W(o,-i.delta,i.shiftKey)?(i._needSkipEvent=!0,!0):!1;var s}}},Ue="dx-textarea",We="dx-texteditor-input",Ye="dx-texteditor-input-auto-resize",Y=me.inherit({_getDefaultOptions:function(){return ge(this.callBase(),{spellcheck:!0,minHeight:void 0,maxHeight:void 0,autoResizeEnabled:!1})},_initMarkup:function(){this.$element().addClass(Ue),this.callBase(),this.setAria("multiline","true")},_renderContentImpl:function(){this._updateInputHeight(),this.callBase()},_renderInput:function(){this.callBase(),this._renderScrollHandler()},_createInput:function(){var e=I("<textarea>");return this._applyInputAttributes(e,this.option("inputAttr")),this._updateInputAutoResizeAppearance(e),e},_applyInputAttributes:function(e,t){e.attr(t).addClass(We)},_renderScrollHandler:function(){this._eventY=0;var e=this._input(),t=Ke(e,!0);f.on(e,x(ve.init,this.NAME),t,L),f.on(e,x(j.down,this.NAME),this._pointerDownHandler.bind(this)),f.on(e,x(j.move,this.NAME),this._pointerMoveHandler.bind(this))},_pointerDownHandler:function(e){this._eventY=G(e).y},_pointerMoveHandler:function(e){var t=G(e).y,o=this._eventY-t;W(this._input(),o)&&(e.isScrollingEvent=!0,e.stopPropagation()),this._eventY=t},_renderDimensions:function(){var e=this.$element(),t=e.get(0),o=this._getOptionValue("width",t),i=this._getOptionValue("height",t),s=this.option("minHeight"),a=this.option("maxHeight");e.css({minHeight:s!==void 0?s:"",maxHeight:a!==void 0?a:"",width:o,height:i})},_resetDimensions:function(){this.$element().css({height:"",minHeight:"",maxHeight:""})},_renderEvents:function(){this.option("autoResizeEnabled")&&f.on(this._input(),x("input paste",this.NAME),this._updateInputHeight.bind(this)),this.callBase()},_refreshEvents:function(){f.off(this._input(),x("input paste",this.NAME)),this.callBase()},_getHeightDifference(e){return N(this._$element.get(0),!1)+N(this._$textEditorContainer.get(0),!1)+N(this._$textEditorInputContainer.get(0),!1)+be("height",fe().getComputedStyle(e.get(0))).margin},_updateInputHeight:function(){if(!!xe()){var e=this._input(),t=this.option("height"),o=t===void 0&&this.option("autoResizeEnabled"),i=o||t===void 0&&this.option("minHeight");if(!i){e.css("height","");return}this._resetDimensions(),this._$element.css("height",Se(this._$element)),e.css("height",0);var s=this._getHeightDifference(e);this._renderDimensions();var a=this._getBoundaryHeight("minHeight"),v=this._getBoundaryHeight("maxHeight"),c=e[0].scrollHeight;if(a!==void 0&&(c=Math.max(c,a-s)),v!==void 0){var h=v-s,b=c>h;c=Math.min(c,h),this._updateInputAutoResizeAppearance(e,!b)}e.css("height",c),o&&this._$element.css("height","auto")}},_getBoundaryHeight:function(e){var t=this.option(e);if(_e(t))return typeof t=="number"?t:De(t,this.$element().get(0).parentElement)},_renderInputType:L,_visibilityChanged:function(e){e&&this._updateInputHeight()},_updateInputAutoResizeAppearance:function(e,t){if(e){var o=Ce(t,this.option("autoResizeEnabled"));e.toggleClass(Ye,o)}},_dimensionChanged:function(){this.option("visible")&&this._updateInputHeight()},_optionChanged:function(e){switch(e.name){case"autoResizeEnabled":this._updateInputAutoResizeAppearance(this._input(),e.value),this._refreshEvents(),this._updateInputHeight();break;case"value":case"height":this.callBase(e),this._updateInputHeight();break;case"minHeight":case"maxHeight":this._renderDimensions(),this._updateInputHeight();break;case"visible":this.callBase(e),e.value&&this._updateInputHeight();break;default:this.callBase(e)}}});Ee("dxTextArea",Y);const qe=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"})),Je=U(qe);/*!
 * devextreme-vue
 * Version: 22.1.5
 * Build date: Fri Sep 02 2022
 *
 * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */var Xe=F&&F.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(B,"__esModule",{value:!0});B.DxTextArea=void 0;var Ze=Xe(Je),Qe=M,q=Qe.createComponent({props:{accessKey:String,activeStateEnabled:Boolean,autoResizeEnabled:Boolean,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,inputAttr:{},isValid:Boolean,label:String,labelMode:String,maxHeight:[Number,String],maxLength:[Number,String],minHeight:[Number,String],name:String,onChange:Function,onContentReady:Function,onCopy:Function,onCut:Function,onDisposing:Function,onEnterKey:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onInput:Function,onKeyDown:Function,onKeyUp:Function,onOptionChanged:Function,onPaste:Function,onValueChanged:Function,placeholder:String,readOnly:Boolean,rtlEnabled:Boolean,spellcheck:Boolean,stylingMode:String,tabIndex:Number,text:String,validationError:{},validationErrors:Array,validationMessageMode:String,validationStatus:String,value:String,valueChangeEvent:String,visible:Boolean,width:[Function,Number,String]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:autoResizeEnabled":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:inputAttr":null,"update:isValid":null,"update:label":null,"update:labelMode":null,"update:maxHeight":null,"update:maxLength":null,"update:minHeight":null,"update:name":null,"update:onChange":null,"update:onContentReady":null,"update:onCopy":null,"update:onCut":null,"update:onDisposing":null,"update:onEnterKey":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onInput":null,"update:onKeyDown":null,"update:onKeyUp":null,"update:onOptionChanged":null,"update:onPaste":null,"update:onValueChanged":null,"update:placeholder":null,"update:readOnly":null,"update:rtlEnabled":null,"update:spellcheck":null,"update:stylingMode":null,"update:tabIndex":null,"update:text":null,"update:validationError":null,"update:validationErrors":null,"update:validationMessageMode":null,"update:validationStatus":null,"update:value":null,"update:valueChangeEvent":null,"update:visible":null,"update:width":null},model:{prop:"value",event:"update:value"},computed:{instance:function(){return this.$_instance}},beforeCreate:function(){this.$_WidgetClass=Ze.default,this.$_hasAsyncTemplate=!0}});B.DxTextArea=q;var et=B.default=q,d={};const tt=Object.freeze(Object.defineProperty({__proto__:null,default:Oe},Symbol.toStringTag,{value:"Module"})),nt=U(tt);/*!
 * devextreme-vue
 * Version: 22.1.5
 * Build date: Fri Sep 02 2022
 *
 * Copyright (c) 2012 - 2022 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */var lt=F&&F.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(d,"__esModule",{value:!0});d.DxSearchEditorOptions=d.DxOptions=d.DxMenuItem=d.DxItemDragging=d.DxItem=d.DxCursorOffset=d.DxButton=d.DxList=void 0;var at=lt(nt),ot=M,g=M,J=ot.createComponent({props:{accessKey:String,activeStateEnabled:Boolean,allowItemDeleting:Boolean,bounceEnabled:Boolean,collapsibleGroups:Boolean,dataSource:{},disabled:Boolean,displayExpr:[Function,String],elementAttr:Object,focusStateEnabled:Boolean,grouped:Boolean,groupTemplate:{},height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,indicateLoading:Boolean,itemDeleteMode:String,itemDragging:Object,itemHoldTimeout:Number,items:Array,itemTemplate:{},keyExpr:[Function,String],menuItems:Array,menuMode:String,nextButtonText:String,noDataText:String,onContentReady:Function,onDisposing:Function,onGroupRendered:Function,onInitialized:Function,onItemClick:Function,onItemContextMenu:Function,onItemDeleted:Function,onItemDeleting:Function,onItemHold:Function,onItemRendered:Function,onItemReordered:Function,onItemSwipe:Function,onOptionChanged:Function,onPageLoading:Function,onPullRefresh:Function,onScroll:Function,onSelectAllValueChanged:Function,onSelectionChanged:Function,pageLoadingText:String,pageLoadMode:String,pulledDownText:String,pullingDownText:String,pullRefreshEnabled:Boolean,refreshingText:String,repaintChangesOnly:Boolean,rtlEnabled:Boolean,scrollByContent:Boolean,scrollByThumb:Boolean,scrollingEnabled:Boolean,searchEditorOptions:Object,searchEnabled:Boolean,searchExpr:[Array,Function,String],searchMode:String,searchTimeout:Number,searchValue:String,selectAllMode:String,selectAllText:String,selectedItemKeys:Array,selectedItems:Array,selectionMode:String,showScrollbar:String,showSelectionControls:Boolean,tabIndex:Number,useNativeScrolling:Boolean,visible:Boolean,width:[Function,Number,String]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:allowItemDeleting":null,"update:bounceEnabled":null,"update:collapsibleGroups":null,"update:dataSource":null,"update:disabled":null,"update:displayExpr":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:grouped":null,"update:groupTemplate":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:indicateLoading":null,"update:itemDeleteMode":null,"update:itemDragging":null,"update:itemHoldTimeout":null,"update:items":null,"update:itemTemplate":null,"update:keyExpr":null,"update:menuItems":null,"update:menuMode":null,"update:nextButtonText":null,"update:noDataText":null,"update:onContentReady":null,"update:onDisposing":null,"update:onGroupRendered":null,"update:onInitialized":null,"update:onItemClick":null,"update:onItemContextMenu":null,"update:onItemDeleted":null,"update:onItemDeleting":null,"update:onItemHold":null,"update:onItemRendered":null,"update:onItemReordered":null,"update:onItemSwipe":null,"update:onOptionChanged":null,"update:onPageLoading":null,"update:onPullRefresh":null,"update:onScroll":null,"update:onSelectAllValueChanged":null,"update:onSelectionChanged":null,"update:pageLoadingText":null,"update:pageLoadMode":null,"update:pulledDownText":null,"update:pullingDownText":null,"update:pullRefreshEnabled":null,"update:refreshingText":null,"update:repaintChangesOnly":null,"update:rtlEnabled":null,"update:scrollByContent":null,"update:scrollByThumb":null,"update:scrollingEnabled":null,"update:searchEditorOptions":null,"update:searchEnabled":null,"update:searchExpr":null,"update:searchMode":null,"update:searchTimeout":null,"update:searchValue":null,"update:selectAllMode":null,"update:selectAllText":null,"update:selectedItemKeys":null,"update:selectedItems":null,"update:selectionMode":null,"update:showScrollbar":null,"update:showSelectionControls":null,"update:tabIndex":null,"update:useNativeScrolling":null,"update:visible":null,"update:width":null},computed:{instance:function(){return this.$_instance}},beforeCreate:function(){this.$_WidgetClass=at.default,this.$_hasAsyncTemplate=!0,this.$_expectedChildren={item:{isCollectionItem:!0,optionName:"items"},itemDragging:{isCollectionItem:!1,optionName:"itemDragging"},menuItem:{isCollectionItem:!0,optionName:"menuItems"},searchEditorOptions:{isCollectionItem:!1,optionName:"searchEditorOptions"}}}});d.DxList=J;var O=g.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:location":null,"update:name":null,"update:options":null},props:{location:String,name:String,options:Object}});d.DxButton=O;O.$_optionName="buttons";O.$_isCollectionItem=!0;O.$_expectedChildren={options:{isCollectionItem:!1,optionName:"options"}};var X=g.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:x":null,"update:y":null},props:{x:Number,y:Number}});d.DxCursorOffset=X;X.$_optionName="cursorOffset";var R=g.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:badge":null,"update:disabled":null,"update:html":null,"update:icon":null,"update:showChevron":null,"update:template":null,"update:text":null,"update:visible":null},props:{badge:String,disabled:Boolean,html:String,icon:String,showChevron:Boolean,template:{},text:String,visible:Boolean}});d.DxItem=R;R.$_optionName="items";R.$_isCollectionItem=!0;var H=g.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:allowDropInsideItem":null,"update:allowReordering":null,"update:autoScroll":null,"update:bindingOptions":null,"update:boundary":null,"update:container":null,"update:contentTemplate":null,"update:cursorOffset":null,"update:data":null,"update:dragDirection":null,"update:dragTemplate":null,"update:dropFeedbackMode":null,"update:elementAttr":null,"update:filter":null,"update:group":null,"update:handle":null,"update:height":null,"update:itemOrientation":null,"update:moveItemOnDrop":null,"update:onAdd":null,"update:onDisposing":null,"update:onDragChange":null,"update:onDragEnd":null,"update:onDragMove":null,"update:onDragStart":null,"update:onInitialized":null,"update:onOptionChanged":null,"update:onPlaceholderPrepared":null,"update:onRemove":null,"update:onReorder":null,"update:rtlEnabled":null,"update:scrollSensitivity":null,"update:scrollSpeed":null,"update:width":null},props:{allowDropInsideItem:Boolean,allowReordering:Boolean,autoScroll:Boolean,bindingOptions:Object,boundary:{},container:{},contentTemplate:{},cursorOffset:[Object,String],data:{},dragDirection:String,dragTemplate:{},dropFeedbackMode:String,elementAttr:Object,filter:String,group:String,handle:String,height:[Function,Number,String],itemOrientation:String,moveItemOnDrop:Boolean,onAdd:Function,onDisposing:Function,onDragChange:Function,onDragEnd:Function,onDragMove:Function,onDragStart:Function,onInitialized:Function,onOptionChanged:Function,onPlaceholderPrepared:Function,onRemove:Function,onReorder:Function,rtlEnabled:Boolean,scrollSensitivity:Number,scrollSpeed:Number,width:[Function,Number,String]}});d.DxItemDragging=H;H.$_optionName="itemDragging";H.$_expectedChildren={cursorOffset:{isCollectionItem:!1,optionName:"cursorOffset"}};var k=g.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:action":null,"update:text":null},props:{action:Function,text:String}});d.DxMenuItem=k;k.$_optionName="menuItems";k.$_isCollectionItem=!0;var Z=g.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:bindingOptions":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:icon":null,"update:onClick":null,"update:onContentReady":null,"update:onDisposing":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onOptionChanged":null,"update:rtlEnabled":null,"update:stylingMode":null,"update:tabIndex":null,"update:template":null,"update:text":null,"update:type":null,"update:useSubmitBehavior":null,"update:validationGroup":null,"update:visible":null,"update:width":null},props:{accessKey:String,activeStateEnabled:Boolean,bindingOptions:Object,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,icon:String,onClick:Function,onContentReady:Function,onDisposing:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onOptionChanged:Function,rtlEnabled:Boolean,stylingMode:String,tabIndex:Number,template:{},text:String,type:String,useSubmitBehavior:Boolean,validationGroup:String,visible:Boolean,width:[Function,Number,String]}});d.DxOptions=Z;Z.$_optionName="options";var P=g.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:accessKey":null,"update:activeStateEnabled":null,"update:bindingOptions":null,"update:buttons":null,"update:disabled":null,"update:elementAttr":null,"update:focusStateEnabled":null,"update:height":null,"update:hint":null,"update:hoverStateEnabled":null,"update:inputAttr":null,"update:isValid":null,"update:label":null,"update:labelMode":null,"update:mask":null,"update:maskChar":null,"update:maskInvalidMessage":null,"update:maskRules":null,"update:maxLength":null,"update:mode":null,"update:name":null,"update:onChange":null,"update:onContentReady":null,"update:onCopy":null,"update:onCut":null,"update:onDisposing":null,"update:onEnterKey":null,"update:onFocusIn":null,"update:onFocusOut":null,"update:onInitialized":null,"update:onInput":null,"update:onKeyDown":null,"update:onKeyUp":null,"update:onOptionChanged":null,"update:onPaste":null,"update:onValueChanged":null,"update:placeholder":null,"update:readOnly":null,"update:rtlEnabled":null,"update:showClearButton":null,"update:showMaskMode":null,"update:spellcheck":null,"update:stylingMode":null,"update:tabIndex":null,"update:text":null,"update:useMaskedValue":null,"update:validationError":null,"update:validationErrors":null,"update:validationMessageMode":null,"update:validationStatus":null,"update:value":null,"update:valueChangeEvent":null,"update:visible":null,"update:width":null},props:{accessKey:String,activeStateEnabled:Boolean,bindingOptions:Object,buttons:Array,disabled:Boolean,elementAttr:Object,focusStateEnabled:Boolean,height:[Function,Number,String],hint:String,hoverStateEnabled:Boolean,inputAttr:{},isValid:Boolean,label:String,labelMode:String,mask:String,maskChar:String,maskInvalidMessage:String,maskRules:{},maxLength:[Number,String],mode:String,name:String,onChange:Function,onContentReady:Function,onCopy:Function,onCut:Function,onDisposing:Function,onEnterKey:Function,onFocusIn:Function,onFocusOut:Function,onInitialized:Function,onInput:Function,onKeyDown:Function,onKeyUp:Function,onOptionChanged:Function,onPaste:Function,onValueChanged:Function,placeholder:String,readOnly:Boolean,rtlEnabled:Boolean,showClearButton:Boolean,showMaskMode:String,spellcheck:Boolean,stylingMode:String,tabIndex:Number,text:String,useMaskedValue:Boolean,validationError:{},validationErrors:Array,validationMessageMode:String,validationStatus:String,value:String,valueChangeEvent:String,visible:Boolean,width:[Function,Number,String]}});d.DxSearchEditorOptions=P;P.$_optionName="searchEditorOptions";P.$_expectedChildren={button:{isCollectionItem:!0,optionName:"buttons"}};var it=d.default=J;const ut={components:{DxDataGrid:we,DxColumn:Ae,DxFilterRow:Te,DxGrouping:Ne,DxGroupPanel:Me,DxSearchPanel:Re,DxHeaderFilter:He,DxScrolling:ke,DxGridToolbar:Pe,DxItem:Ve,DxSelectBox:$e,DxGridButton:ze,DxPopup:ie,DxToolbarItem:ue,DxTextBox:de,DxButton:Le,DxTextArea:et,DxScrollView:je,DxList:it},data:()=>({showPopup:!1,crudTitle:"Detalle de Incidencia",items:[],sectors:[],incidentTypes:[],model:{type:{}},filterState:"OPEN"}),mounted(){this.listOpen(),this.loadAllSelects()},methods:{formatTimestamp(e){return Ie(e,"dd/MM/yyyy HH:mm")},async loadAllSelects(){this.sectors=await se(),this.incidentTypes=await pe()},create(){let e=re();this.model={status:"IN_PROCESS",userName:e.fullName,user:{intranet:!0,name:e.fullName},registerDate:"AHORA",type:{id:null}},this.showPopup=!0},listOpen(){let e=[{field:"status",operator:"==",value:"OPEN"}];this.listAll(e)},onClosePopup(){this.showPopup=!1},getStatus(e){switch(e){case"OPEN":return{name:"Abierta",color:"white",backgroundColor:"#03A9F0"};case"IN_PROCESS":return{name:"En Proceso",color:"white",backgroundColor:"#8bc34a"};case"CLOSED":return{name:"Cerrada",color:"white",backgroundColor:"#333"};case"REJECTED":return{name:"Rechazada",color:"white",backgroundColor:"#f44336"};default:return{}}},async createAndStart(){let e=Object.assign({},this.model),t=this.incidentTypes.filter(i=>i.id==e.type.id).pop();e.registerDate=ce(),e.type=t;let o=e.sector;e.sector=o.name,e.status="IN_PROCESS",await $(e),e.id&&(z("Registro guardado con \xE9xito","success",3e3),this.listCurrentStatus(),this.showPopup=!1)},start(){this.update("IN_PROCESS")},reject(){this.update("REJECTED")},close(){this.update("CLOSED")},update(e){Ge("Seguro deseas cambiar el estado","Confirmar").then(o=>{if(o){let i=Object.assign({},this.model);i.status=e,$(i),this.showPopup=!1,z("Cambio realizado con \xE9xito","success",3e3)}})},listCurrentStatus(){let e=[{field:"status",operator:"==",value:this.filterState}];this.listAll(e)},showDetail(e){this.model=e,this.showPopup=!0},async listAll(e){this.items=await oe(e)},filterChange(e){let t=e.value,o=[{field:"status",operator:"==",value:t}];this.listAll(o)}}},dt={style:{padding:"10px",width:"100vw","box-sizing":"border-box"}},rt=n("label",{style:{"font-size":"1.2em","margin-bottom":"5px"}},"Incidencias",-1),st=["onClick"],pt=n("i",{class:"dx-icon-doc"},null,-1),ct={class:"dx-field"},ht=n("div",{class:"dx-field-label"},"Sector",-1),mt={class:"dx-field-value"},gt={class:"dx-field"},vt=n("div",{class:"dx-field-label"},"Tipo",-1),bt={class:"dx-field-value"},ft={class:"dx-field"},xt=n("div",{class:"dx-field-label"},"Estado",-1),St={class:"dx-field-value"},_t={class:"dx-field"},Dt=n("div",{class:"dx-field-label"},"Descripci\xF3n",-1),Ct={class:"dx-field-value"},Et={class:"dx-field"},yt=n("div",{class:"dx-field-label"},"Registrado por",-1),It={class:"dx-field-value"},Ft={class:"dx-field"},Bt=n("div",{class:"dx-field-label"},"Registrado",-1),Ot={class:"dx-field-value"},wt={class:"dx-field"},At=n("div",{class:"dx-field-label"},"Adjuntos",-1),Tt={class:"dx-field-value"},Nt=["href"];function Mt(e,t,o,i,s,a){const v=r("DxFilterRow"),c=r("DxHeaderFilter"),h=r("DxSearchPanel"),b=r("DxScrolling"),w=r("DxGroupPanel"),m=r("DxColumn"),A=r("DxItem"),Q=r("DxGridToolbar"),V=r("DxButton"),T=r("DxSelectBox"),ee=r("DxDataGrid"),te=r("DxTextArea"),ne=r("DxList"),le=r("DxScrollView"),D=r("DxToolbarItem"),ae=r("DxPopup");return S(),Fe("div",dt,[rt,l(ee,{id:"dataGrid",ref:"dataGridRef","data-source":e.items,"key-expr":"id","show-borders":!0,height:"calc(100vh - 72px)",width:"100%","allow-column-resizing":!0},{typeTemplate:p(({data:u})=>[n("span",{style:C({backgroundColor:u.data.type.backgroundColor,color:u.data.type.foregroundColor,padding:"5px",borderRadius:"15px"})},[n("i",{class:Be(u.data.type.icon)},null,2),K(" "+_(u.data.type.name),1)],4)]),timestampTemplate:p(({data:u})=>[n("span",null,_(u.data.registerDate?a.formatTimestamp(u.data.registerDate.toDate()):"-"),1)]),buttonsTemplate:p(({data:u})=>[n("a",{onClick:Rt=>a.showDetail(u.data),style:{cursor:"pointer",color:"blue"}},[pt,K("\xA0Ver")],8,st)]),createButton:p(()=>[l(V,{icon:"add",onClick:a.create,text:"Crear",type:"default"},null,8,["onClick"])]),byStatusFilter:p(()=>[l(T,{width:"200","display-expr":"text","value-expr":"value",modelValue:e.filterState,"onUpdate:modelValue":t[0]||(t[0]=u=>e.filterState=u),items:[{value:"OPEN",text:"Abiertas"},{value:"IN_PROCESS",text:"En proceso"},{value:"CLOSED",text:"Cerradas"},{value:"REJECTED",text:"Rechazadas"}],onValueChanged:a.filterChange},null,8,["modelValue","onValueChanged"])]),refreshButton:p(()=>[l(V,{icon:"refresh",onClick:a.listCurrentStatus},null,8,["onClick"])]),default:p(()=>[l(v,{visible:!0}),l(c,{visible:!0}),l(h,{visible:!0,width:240,placeholder:"Buscar..."}),l(b,{mode:"virtual"}),l(w,{visible:!0}),l(m,{width:"100",caption:"Tipo","cell-template":"typeTemplate","data-field":"type.name","sort-order":"asc"}),l(m,{width:"120","data-field":"sector",caption:"Sector","sort-order":"asc"}),l(m,{"data-field":"description",caption:"Descripci\xF3n"}),l(m,{width:"140","data-field":"userName",caption:"Registrado por"}),l(m,{width:"140","data-field":"registerDate",caption:"Fecha","sort-order":"asc","cell-template":"timestampTemplate"}),l(m,{type:"buttons",width:110,"cell-template":"buttonsTemplate"}),l(Q,null,{default:p(()=>[l(A,{location:"before",template:"createButton"}),l(A,{location:"after",template:"byStatusFilter"}),l(A,{location:"after",template:"refreshButton"})]),_:1})]),_:1},8,["data-source"]),l(ae,{visible:e.showPopup,"drag-enabled":!0,"hide-on-outside-click":!1,"show-close-button":!0,"show-title":!0,width:400,height:400,title:e.crudTitle,"on-hidden":a.onClosePopup},{default:p(()=>[l(le,{height:"calc(400px - 135px)"},{default:p(()=>[n("div",ct,[ht,n("div",mt,[l(T,{modelValue:e.model.sector,"onUpdate:modelValue":t[1]||(t[1]=u=>e.model.sector=u),"data-source":e.sectors,"display-value":"name","display-expr":"name"},null,8,["modelValue","data-source"])])]),n("div",gt,[vt,n("div",bt,[l(T,{modelValue:e.model.type,"onUpdate:modelValue":t[2]||(t[2]=u=>e.model.type=u),"data-source":e.incidentTypes,"display-value":"id","display-expr":"name"},null,8,["modelValue","data-source"])])]),n("div",ft,[xt,n("div",St,[n("label",{style:C({lineHeight:"2.5em",color:a.getStatus(e.model.status).color,backgroundColor:a.getStatus(e.model.status).backgroundColor,padding:"5px",borderRadius:"15px"})},_(a.getStatus(e.model.status).name),5)])]),n("div",_t,[Dt,n("div",Ct,[l(te,{height:90,modelValue:e.model.description,"onUpdate:modelValue":t[3]||(t[3]=u=>e.model.description=u)},null,8,["modelValue"])])]),n("div",Et,[yt,n("div",It,[n("label",{style:C({lineHeight:"2.5em"})},_(e.model.userName),5)])]),n("div",Ft,[Bt,n("div",Ot,[n("label",{style:C({lineHeight:"2.5em"})},_(e.model.id?a.formatTimestamp(e.model.registerDate.toDate()):"AHORA"),5)])]),n("div",wt,[At,n("div",Tt,[l(ne,{"data-source":e.model.media},{item:p(({data:u})=>[n("a",{href:u,target:"_blank"},"Ver Adjunto",8,Nt)]),_:1},8,["data-source"])])])]),_:1}),e.model.status=="IN_PROCESS"&&!e.model.id?(S(),E(D,{key:0,widget:"dxButton",toolbar:"bottom",location:"after",options:{text:"Crear e Iniciar",type:"success",onClick:a.createAndStart}},null,8,["options"])):y("",!0),e.model.status=="OPEN"&&e.model.id?(S(),E(D,{key:1,widget:"dxButton",toolbar:"bottom",location:"after",options:{text:"Iniciar",type:"success",onClick:a.start}},null,8,["options"])):y("",!0),e.model.status=="IN_PROCESS"&&e.model.id?(S(),E(D,{key:2,widget:"dxButton",toolbar:"bottom",location:"after",options:{text:"Cerrar",type:"default",onClick:a.close}},null,8,["options"])):y("",!0),e.model.status=="OPEN"&&e.model.id?(S(),E(D,{key:3,widget:"dxButton",toolbar:"bottom",location:"before",options:{text:"Rechazar",type:"danger",onClick:a.reject}},null,8,["options"])):y("",!0)]),_:1},8,["visible","title","on-hidden"])])}const Kt=ye(ut,[["render",Mt]]);export{Kt as default};
